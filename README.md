# Nessus Vulnerability Management Homelab

In this homelab project, I will use VirtualBox to create a vulnerable Windows 10 virtual machine, which I will scan for vulnerabilities with Nessus Essentials and proceed to remediate them. This project is a showcase of the following steps of the Vulnerabilty Management Lifecycle:
- Discover
- Prioritize
- Assess
- Remediate

## Downloads
- [Windows 10 ISO](https://www.microsoft.com/en-us/software-download/windows10)
- [VirtualBox](https://www.virtualbox.org/wiki/Downloads)
- [Nessus Essentials](https://www.tenable.com/products/nessus/nessus-essentials)

## Project Walk-through

### Setting up vulnerable Windows 10 VM

First priority is to download and run the Nesses Essentials installer file. It will take some time to finitish initializing, so while that is going, we can setup our Windows 10 virtual machine and configure while we wait

![Nessus-Initialization](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/f22a8998-ce6e-449b-9a03-220e43cbb8ce)

When setting up the Windows 10 VM, we want to configure the network adapter to be bridged, so that we can be on the same network as my host machine. This facilitates the Nessus implementation's communication with our VM.

![Win-10-Vuln-Network](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/cd96b619-22f6-43d3-8f61-ca41e9223492)

Once the vm is setup, we'll do an initial `ping` to verify that we're able to communicate with it, but as we can see below, it looks like our ICMP packets
aren't going through.

![Screenshot 2023-11-27 190207](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/d980b128-a366-451a-9810-fd9df3af9245)

This is most likely because the Windows 10 firewall is enabled, so let's disable it:

![Disable-win-firewall](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/eb770fbb-79a2-4cd5-9c6b-65cba7c17af9)

Now that the firewall is disabled, let's retry pinging the vm with our host machine and now we should see that we get a response from the vm.

![ping-success](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/b7547b86-0055-4c6f-a061-247294ba1534)

### Configuring Nessus Essentials

By now, Nessus Essentials should be fully initialized

![create-win-10-non-cred-scan](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/50f01515-72f3-46d0-8540-fb6ce8ff605a)

Launch the scan:

![start-uncred-scan](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/d56b1b24-5aaf-420c-93c9-23d658c92d28)

Scan results:

![uncredentialed-scan-results](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/e26a29c4-e2b3-461a-a1e4-92863e820c2d)

INFO results Target Credential Status by Authentication Protocol - No Credentials Provided

![Screenshot 2023-11-27 193124-highlight](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/d1dba09c-2bc7-49c7-b0bc-ba0ea40e082b)


### Configure VM to accept authenticated scans.

Enable remote registry

![enable-remote-registry](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/1bce07e7-f9f5-47bc-b445-97f1df24ee46)

Following Nessus documentation to configure local homelab for credentialed scan. This should never be done in production environment. Change User Account Control settings to "Never notify" when apps are installed or Windows settings are changed.

Network sharing settings:

![enable-public-folder-sharing](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/4da6ee02-821c-4eee-9e81-4d6921004310)

Change User Account Controls to not notify when Windows settings have been changed or apps have been installed.

![disable-user-account-control-notif](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/6336799f-4406-411e-b860-2d3198093637)

In RegEdit, we will need to add a DWORD value and name it LocalAccountTokenFilterPolicy and give it a value of 1:

Registry folder path: `Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System`

![regedit](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/7dc78c26-a9c1-4575-bc73-89369cbcf56e)

After we're done in regedit, we'll need to restart the VM for the changes to take effect.

### Add credentialed scan to Nessus

![cred-scan-nessus](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/ec7835c6-5131-4c79-8b2e-7d4925f53230)

Then we run the scan again:

New scan results show way more vulnerabilitys than the initial scan, since it is able to scan deeper into the system with the credentials we porvided.

![Screenshot 2023-11-27 205358](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/46d9f7dd-10c8-47cf-85a7-af9f50469540)
![Screenshot 2023-11-27 205520](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/c02b9e36-d3be-4e1e-a7c1-0a4c1d766087)

After installing old version of Firefox scan:

![Screenshot 2023-11-27 213202](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/67df55d8-ebc0-4de1-b306-c3e62abf2ea3)

We see that a lot of the critical alerts are from the Firefox installation. Next is remediation:

![firefox-scan-results](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/487bd809-4ef7-4bb9-a9f7-fac5ff1dc749)

### Remediate

Uninstall Firefox:

![uninstall-firefox](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/c689cba0-3e5e-409c-a69d-39767fc2952c)

Update Windows:

![update-windows](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/e695c1ad-9360-404c-a686-24f300888a02)

After a restart and a few more installs, we're updated

![Screenshot 2023-11-27 215049](https://github.com/dmnuggins/Nessus-Vulnerability-Management-Homelab/assets/7257923/7378af77-4cc4-40a8-a0c4-07229db8123d)

Do one final scan to see the difference in results after remediation.